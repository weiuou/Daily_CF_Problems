**提示 1：** 相邻两项往往是相同的，但我们又要求前缀异或和，所以……

注意， $\lfloor\frac{x}{2}\rfloor$ 在一对一对相等的情况。

具体而言， $2k,2k+1$ 两个下标的数值，总是相同的。

所以在求前缀异或和的情况下，中间这些相同的部分也就完全抵消掉了。最后就剩下了开头的部分，还有最后可能的 $a_{\lfloor\frac{m}{2}\rfloor}$ ，如果这个元素只出现了一次。

所以， $a_m$ 就变成了 $a_{\lfloor\frac{m}{2}\rfloor}$ 和最开头不重复的前缀的异或和。

因此，可以使用递归解决该问题——

在 $m\leq 2n$ 的情况下，直接利用定义得到结果。

否则，可以通过上面的递推关系，把 $m$ 缩小为原来的二分之一，这样 $\mathcal{O}(\log M)$ 轮后就能足够小了。

时间复杂度为 $\mathcal{O}(n+\log M)$ 。

### 具体代码如下——

Python 做法如下——

```Python []
def main():
    t = II()
    outs = []
    
    for _ in range(t):
        n, l, r = MII()
        nums = LII()
        
        if n % 2 == 0:
            v = 0
            for i in range(n // 2):
                v ^= nums[i]
            nums.append(v)
            n += 1
        
        total = reduce(xor, nums)
        
        def solve(x):
            if x <= n: return nums[x - 1]
            
            if x <= 2 * n:
                ans = 0
                for i in range(x // 2):
                    ans ^= nums[i]
                return ans
            
            v = x // 2
            if v % 2 == 0: return total ^ solve(v) 
            return total
        
        outs.append(solve(l))
    
    print('\n'.join(map(str, outs)))
```

C++ 做法如下——

```cpp []
int main() {
    ios_base::sync_with_stdio(false);
    cin.tie(0);
    cout.tie(0);

    int t;
    cin >> t;

    while (t --) {
        int n;
        long long l, r;
        cin >> n >> l >> r;

        vector<int> nums(n);
        for (auto &x: nums) cin >> x;

        if (n % 2 == 0) {
            int v = 0;
            for (int i = 0; i < n / 2; i ++)
                v ^= nums[i];
            nums.emplace_back(v);
            n ++;
        }

        int total = 0;
        for (auto &v: nums) total ^= v;

        auto solve = [&] (auto &self, long long x) -> int {
            if (x <= n) return nums[x - 1];

            if (x <= n * 2) {
                int ans = 0;
                for (int i = 0; i < x / 2; i ++)
                    ans ^= nums[i];
                return ans;
            }

            long long v = x / 2;
            if (v % 2 == 0) return total ^ self(self, v);
            return total;
        };

        cout << solve(solve, l) << '\n';
    }

    return 0;
}
```