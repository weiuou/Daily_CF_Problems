**提示 1：** 当一个文件刚上传上来时，需要快速找到第一个结束压缩的服务器，于是我们要维护这个东西。

模拟题，想清楚维护什么东西就行。

我们需要的是，在一个视频出现后，找到一个服务器来压缩它。这个服务器是最早结束上一个压缩任务的。

然后同时我们需要更新其结束压缩任务的时间为当前任务的结束时间。

于是我们要维护一个结构，能够快速找到最小值，并修改该元素，重新放回结构中。显然小顶堆可以完成这样的事情。

每次，弹出小顶堆的最小元素，再和当前任务的最早开始时间取最大值，再加上当前任务所需时间，再推回小顶堆中即可。

时间复杂度为 $\mathcal{O}(n\log k+k)$ 。

### 具体代码如下——

Python 做法如下——

```Python []
def main():
    n, k = MII()
    cur = [0] * k
    
    outs = []
    
    for _ in range(n):
        s, m = MII()
        x = heappop(cur)
        x = fmax(x, s) + m
        
        outs.append(x)
        heappush(cur, x)
    
    print('\n'.join(map(str, outs)))
```

C++ 做法如下——

```cpp []
int main() {
    ios_base::sync_with_stdio(false);
    cin.tie(0);
    cout.tie(0);

    int n, k;
    cin >> n >> k;

    priority_queue<long long, vector<long long>, greater<long long>> pq;

    for (int i = 0; i < k; i ++) pq.push(0);

    while (n --) {
        long long s, m;
        cin >> s >> m;

        long long t = pq.top(); pq.pop();
        t = max(t, s) + m;

        cout << t << '\n';
        pq.push(t);
    }

    return 0;
}
```